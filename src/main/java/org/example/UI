package org.example;


import javafx.scene.control.Button;
import javafx.scene.control.ScrollPane;
import javafx.scene.control.TextArea;
import javafx.scene.control.TextField;
import javafx.scene.layout.BorderPane;
import javafx.scene.layout.HBox;
import javafx.scene.layout.Pane;
import javafx.scene.layout.Priority;
import javafx.stage.Stage;
import javafx.scene.Scene;
import javafx.application.Application;

import javax.swing.*;

public class IU extends Application {
    Button CambioModo;
    Button Modo;
    Button Recorridos;
    Button raiz;
    Button nodo;
    Button cambioRec;

    TextField Datos;
    ScrollPane Scroll;
    TextArea TextoRecorridos;

    BorderPane PanelPrincial;
    HBox ControlesInferiores;
    Pane PanelCentral;

    Boolean Eliminar = false;
    Boolean Cambio= false;
    Boolean ApoyoCamb=false;

    Node datoRaiz;;
    int datoNuevo;
    int NivelActual;
    double x,y;
    int clik;
    String Texto;
    @Override
    public void start(Stage stage) throws Exception {
        BinaryTree arbol = new BinaryTree();


        PanelPrincial = new BorderPane();
        ControlesInferiores = new HBox();
        PanelCentral = new Pane();
        Scroll = new ScrollPane();

        TextoRecorridos = new TextArea();
        TextoRecorridos.setPrefRowCount(1);


        arbol.inOrder();
        arbol.preOrder();
        arbol.postOrder();


        CambioModo = new Button("Cambiar");
         Recorridos= new Button("");
        cambioRec=new Button("Cambiar");

        Modo = new Button("+");
        Datos = new TextField();

        ControlesInferiores.getChildren().addAll(CambioModo, Modo, Datos,Recorridos,cambioRec);
        ControlesInferiores.setSpacing(10);
        HBox.setHgrow(Datos, Priority.ALWAYS);

        PanelCentral.setMaxWidth(Double.MAX_VALUE);
        Datos.setMaxWidth(Double.MAX_VALUE);

        Scroll.setContent(PanelCentral);
        Scroll.setFitToWidth(true);
        Scroll.setFitToHeight(true);
        Scroll.setFitToWidth(true);

        PanelPrincial.setBottom(ControlesInferiores);
        PanelPrincial.setCenter(Scroll);
        PanelPrincial.setTop(TextoRecorridos);




        CambioModo.setOnAction(Event -> {
            if (Eliminar == true) {
                Modo.setText("+");
                Eliminar = false;
            } else {
                Modo.setText("-");
                Eliminar = true;
            }

        });

 cambioRec.setOnAction(Event ->{
     clik++;
     switch (clik){
         case 1:
             Recorridos.setText("Recorrido INorder");
             Texto=arbol.inOrder();
             TextoRecorridos.setText(Texto);

             break;
         case 2:
             Recorridos.setText("Recorrido POSTorder");
            String TextoPos=arbol.postOrder();
             TextoRecorridos.setText(TextoPos);
             break;
         case 3:// falla 
             Recorridos.setText("Recorrido PREorder");
             String TextoPre=arbol.postOrder();
             TextoRecorridos.setText(TextoPre);
             arbol.preOrder();
             clik=0;
             break;

     }


 });
        Modo.setOnAction(Event ->{
        if (Eliminar == false) {
            if(raiz==null){
             raiz = new Button();
            raiz.setText(Datos.getText());
            datoRaiz = new Node(Integer.parseInt(Datos.getText()));
            datoRaiz.visual = raiz;
            arbol.setRoot(datoRaiz);
            PanelCentral.getChildren().add(raiz);
            Datos.clear();
                raiz.setLayoutX(PanelCentral.getWidth() / 2);
                raiz.setLayoutY(30);
        } else if(raiz!=null) {
                nodo = new Button(Datos.getText());
                datoNuevo = Integer.parseInt(Datos.getText());
                Datos.clear();
                calcularLugar(datoNuevo, raiz, 1, datoRaiz);
                nodo.setStyle("-fx-background-radius: 50%;");
            }
    }
});







        Scene escena = new Scene(PanelPrincial, 500, 400);
        stage.setTitle("prueba");
        stage.setScene(escena);
        stage.show();
    }
    public void calcularLugar(int peso, Button padreVisual, int nivelActual, Node nodoLogicoPadre){
        int DatoPadre = (Integer.parseInt(padreVisual.getText()));
        double Espacio = (PanelCentral.getWidth() / 2) / Math.pow(2, nivelActual);
        if(peso<DatoPadre){
            if(nodoLogicoPadre.getLeft()==null){
           PanelCentral.getChildren().add(nodo);
           nodo.setLayoutY(padreVisual.getLayoutY() + 70);
           nodo.setLayoutX(padreVisual.getLayoutX() - Espacio);
           Node nuevoHijo = new Node(peso);
           nuevoHijo.visual = nodo;
           nodoLogicoPadre.setLeft(nuevoHijo);
            }else {
                calcularLugar(peso, nodoLogicoPadre.getLeft().visual, nivelActual + 1, nodoLogicoPadre.getLeft());
            }
        }
if(peso>DatoPadre){
if(nodoLogicoPadre.getRight()==null){
    PanelCentral.getChildren().add(nodo);
    nodo.setLayoutY(padreVisual.getLayoutY() + 70);
    nodo.setLayoutX(padreVisual.getLayoutX() + Espacio);
    Node nuevoHijo = new Node(peso);
    nuevoHijo.visual = nodo;
    nodoLogicoPadre.setRight(nuevoHijo);
}else{
    calcularLugar(peso, nodoLogicoPadre.getRight().visual, nivelActual + 1, nodoLogicoPadre.getRight());
}

}
    }
}

